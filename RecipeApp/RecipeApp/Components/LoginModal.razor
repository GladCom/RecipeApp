@rendermode InteractiveServer
@inject AuthService AuthService

@if (IsVisible)
{
    <div class="login-overlay">
        <div class="login-modal">
            <div class="login-header">
                <h2>@(IsRegistrationMode ? "Регистрация" : "Авторизация")</h2>
            </div>

            <div class="login-body">
                <div class="form-group">
                    <label for="username" class="form-label">Логин:</label>
                    <input type="text"
                           id="username"
                           class="login-input"
                           @bind="Username"
                           placeholder="Введите логин"
                           @onkeydown="@(async e => { if (e.Key == "Enter") await SubmitForm(); })" />
                </div>

                <div class="form-group">
                    <label for="password" class="form-label">Пароль:</label>
                    <input type="password"
                           id="password"
                           class="login-input"
                           @bind="Password"
                           placeholder="Введите пароль"
                           @onkeydown="@(async e => { if (e.Key == "Enter") await SubmitForm(); })" />
                </div>

                @if (IsRegistrationMode)
                {
                    <div class="form-group">
                        <label for="confirmPassword" class="form-label">Подтвердите пароль:</label>
                        <input type="password"
                               id="confirmPassword"
                               class="login-input"
                               @bind="ConfirmPassword"
                               placeholder="Повторите пароль"
                               @onkeydown="@(async e => { if (e.Key == "Enter") await SubmitForm(); })" />
                    </div>
                }

                @if (!string.IsNullOrEmpty(ErrorMessage))
                {
                    <div class="error-message">
                        @ErrorMessage
                    </div>
                }
            </div>

            <div class="login-footer">
                <button class="login-btn" @onclick="SubmitForm">
                    @(IsRegistrationMode ? "Зарегистрироваться" : "Войти")
                </button>
                
                <div class="form-switch">
                    <button type="button" class="switch-btn" @onclick="ToggleMode">
                        @(IsRegistrationMode ? "Уже есть аккаунт? Войти" : "Нет аккаунта? Зарегистрироваться")
                    </button>
                </div>
            </div>
        </div>
    </div>
}